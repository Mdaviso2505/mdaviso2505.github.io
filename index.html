<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GDPR + Netpub Ad Example</title>

  <!-- GDPR CMP Script (Netpub) -->
  <script type="text/javascript" src="https://fstatic.netpub.media/extra/cmp/cmp-gdpr.js" defer></script>

  <style>
    .ad-container {
      width: 100%;
      max-width: 336px;
      margin: 20px auto;
      text-align: center;
    }
  </style>

  <script>
    // Wait for the page to load
    window.addEventListener("load", function () {
      const loadNetpubAd = () => {
        // Load Netpub banner ad script dynamically
        const scriptId = "209672a34f4e9fe3b7d663799d7e6ff5";
        if (!document.getElementById(scriptId)) {
          const s = document.createElement("script");
          s.id = scriptId;
          s.async = true;
          s.src = `https://fstatic.netpub.media/static/${scriptId}.min.js?${Date.now()}`;
          document.head.appendChild(s);
        }
      };

      // Check for GDPR consent via __tcfapi
      const checkConsent = () => {
        if (typeof __tcfapi === 'function') {
          __tcfapi('getTCData', 2, function (tcData, success) {
            if (success) {
              console.log('GDPR Consent Data:', tcData);
              if (tcData.purpose.consents[1]) {
                console.log("Consent granted. Loading Netpub banner ad...");
                loadNetpubAd();
              } else {
                console.warn("Consent denied. Ad not loaded.");
              }
            }
          });
        } else {
          console.warn("__tcfapi not available yet.");
        }
      };

      // Give time for CMP to initialize
      setTimeout(checkConsent, 1000);
    });
  </script>
</head>
<body>
  <h1>Welcome!</h1>
  <p>This site uses cookies and may show ads if you consent.</p>

  <!-- Netpub Ad Banner Container -->
  <div class="ad-container">
    <ins class="adv-209672a34f4e9fe3b7d663799d7e6ff5"
         data-sizes-desktop="200x200,250x250,300x250,336x280"
         data-sizes-mobile="200x200,250x250,300x250,336x280"
         data-slot="1"></ins>
  </div>
</body>
</html>
